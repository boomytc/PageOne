<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 15.1.0.0" /><title></title></head><body><div><p style="font-size:18pt; line-height:125%; margin:0pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:center; widows:0"><span style="font-family:宋体; font-size:18pt; font-weight:bold">文档</span><span style="font-family:'Times New Roman'; font-size:18pt; font-weight:bold">11 </span><span style="font-family:宋体; font-size:18pt; font-weight:bold">上传</span><span style="font-family:'Times New Roman'; font-size:18pt; font-weight:bold">/</span><span style="font-family:宋体; font-size:18pt; font-weight:bold">富文本</span><span style="font-family:'Times New Roman'; font-size:18pt; font-weight:bold">/Excel</span><span style="font-family:宋体; font-size:18pt; font-weight:bold">导入与导出</span></p><h2 style="font-size:16pt; line-height:125%; margin:0pt 0pt 0pt 28.35pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-28.35pt; widows:0"><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">11.1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:黑体; font-size:16pt; font-weight:bold">表字段</span><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">-</span><span style="font-family:黑体; font-size:16pt; font-weight:bold">单文件上传</span></h2><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:'Times New Roman'; font-size:12pt">Web</span><span style="font-family:宋体; font-size:12pt">环境下，文件上传都是在数据库中存储文件的路径，文件存放在服务器磁盘中。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">单文件上传指数据库表字段中存放上传文件的路径</span><span style="font-family:宋体; font-size:12pt">，需要在单据</span><span style="font-family:宋体; font-size:12pt">的新增和修改界面提供上传控件来完成数据的上传，类似图书的封面图，具体的开发方法见下边的步骤：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">以图书表的封面图为例子：</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">11.1.1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">调整视图代码</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">把对应表单控件换成上传表单控件</span><span style="font-family:宋体; font-size:12pt">和展示控件</span><span style="font-family:宋体; font-size:12pt">。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">新增的</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><img src="index.001.png" width="440" height="115" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span style="font-family:宋体; font-size:10.5pt"> </span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">修改的：</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><img src="index.002.png" width="576" height="167" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:10.5pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">1</span><span style="font-family:宋体; font-size:10.5pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:10.5pt">需要展示出</span><span style="font-family:宋体; font-size:10.5pt">以前的上传图片。</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">2</span><span style="font-family:宋体; font-size:10.5pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:10.5pt">要把以前上传的图片地址保存在隐藏表单</span><span style="font-family:宋体; font-size:10.5pt">中，如果未上传，则给服务器提交以前的值，当需要检查图片必须上传</span><span style="font-family:宋体; font-size:10.5pt">的时候方便检查。</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">3</span><span style="font-family:宋体; font-size:10.5pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:10.5pt">为了能够将以前的值放在隐藏表单中，因此上传控件的名称不能和字段名相同。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">详情的：</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><img src="index.003.png" width="543" height="112" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.1.2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">调整</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">业务类</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">当单击新增视图或修改视图的“保存”按钮时，获取上传的文件，并存放到数据库中，新增和修改的代码雷同：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">新增的：</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><img src="index.004.png" width="613" height="334" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 38.85pt; orphans:0; text-align:justify; text-indent:-17.55pt; widows:0"><span style="font-family:Wingdings; font-size:12pt"></span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码解读：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">调用封装好的</span><span style="font-family:'Times New Roman'; font-size:12pt">saveUploadFiles</span><span style="font-family:宋体; font-size:12pt">方法，第一个参数是图片保存位置，第二个参数是前端</span><span style="font-family:'Times New Roman'; font-size:12pt">input</span><span style="font-family:宋体; font-size:12pt">表单</span><span style="font-family:宋体; font-size:12pt">的名称。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">第一个参数路径最后不携带“</span><span style="font-family:'Times New Roman'; font-size:12pt">/</span><span style="font-family:宋体; font-size:12pt">”符号。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">默认只能上传一张图片，因此这里取第一张图片作为封面图。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">修改的</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><img src="index.005.png" width="611" height="204" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 38.85pt; orphans:0; text-align:justify; text-indent:-17.55pt; widows:0"><span style="font-family:Wingdings; font-size:12pt"></span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码解读：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">和新增做法一样，需要注意的时，对模型中其它属性的变更一定要放在</span><span style="font-family:'Times New Roman'; font-size:12pt">entryUpdate()</span><span style="font-family:宋体; font-size:12pt">方法的下方。</span></p><h2 style="font-size:16pt; line-height:125%; margin:0pt 0pt 0pt 28.35pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-28.35pt; widows:0"><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">11.2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:黑体; font-size:16pt; font-weight:bold">单据附件</span><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">-</span><span style="font-family:黑体; font-size:16pt; font-weight:bold">多文件上传</span></h2><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">多文件上传主要用于单据的附件，例如入库单，在创建入库单的时候，需要把和入库有关的单据附件上传上去，</span><span style="font-family:宋体; font-size:12pt">允许传递多个附件，这种方式</span><span style="font-family:宋体; font-size:12pt">在框架中已完成了大部分工作，只需要在需要附件的单据上增加对应的代码即可</span><span style="font-family:宋体; font-size:12pt">（类似主表挂载从表的做法）</span><span style="font-family:宋体; font-size:12pt">，具体方法见下边</span><span style="font-family:宋体; font-size:12pt">的步骤。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.2.1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">修改模式下挂载</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在单据主表的</span><span style="font-family:宋体; font-size:12pt">修改</span><span style="font-family:宋体; font-size:12pt">视图</span><span style="font-family:宋体; font-size:12pt">下方</span><span style="font-family:宋体; font-size:12pt">挂载如下的代码（以入库单为例）：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">需要</span><span style="font-family:宋体; font-size:12pt">放在</span><span style="font-family:'Times New Roman'; font-size:12pt">form</span><span style="font-family:宋体; font-size:12pt">表单的外边</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">&lt;fieldset&gt;</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    &lt;legend&gt;</span><span style="font-family:宋体; font-size:10.5pt">相关附件</span><span style="font-family:'Times New Roman'; font-size:10.5pt">&lt;/legend&gt;</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    @{</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        var routeValue = new</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        {</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">            attachResourceCode = "bks_BookStock",  //</span><span style="font-family:宋体; font-size:10.5pt">资源标识</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:'Times New Roman'; font-size:10.5pt">attachKeyCode = Model.stockCode,  //</span><span style="font-family:宋体; font-size:10.5pt">单据主键值</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:'Times New Roman'; font-size:10.5pt">attachOpMode = "</span><span style="font-family:'Times New Roman'; font-size:10.5pt">Update</span><span style="color:#a31515; font-family:NSimSun; font-size:9.5pt">"</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        };</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        Html.RenderAction("SelectPartial", "sys_BillAttach", routeValue);</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    }</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">&lt;/fieldset&gt;</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">运行效果：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.006.png" width="516" height="294" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.2.2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">详情模式下挂载</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在单据</span><span style="font-family:宋体; font-size:12pt">主表</span><span style="font-family:宋体; font-size:12pt">的</span><span style="font-family:宋体; font-size:12pt">详情视图挂载</span><span style="font-family:宋体; font-size:12pt">如下的</span><span style="font-family:宋体; font-size:12pt">代码（以入库单为例）：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在详情视图的最下边加入如下的代码：</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">&lt;fieldset&gt;</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    &lt;legend&gt;</span><span style="font-family:宋体; font-size:10.5pt">相关附件</span><span style="font-family:'Times New Roman'; font-size:10.5pt">&lt;/legend&gt;</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    @{</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        var routeValue = new</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        {</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">            attachResourceCode = "bks_BookStock",  //</span><span style="font-family:宋体; font-size:10.5pt">资源标识</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:'Times New Roman'; font-size:10.5pt">attachKeyCode = Model.stockCode,  //</span><span style="font-family:宋体; font-size:10.5pt">单据主键值</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:'Times New Roman'; font-size:10.5pt">attachOpMode = "Detail"</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        };</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">        Html.RenderAction("SelectPartial", "sys_BillAttach", routeValue);</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    }</span></p><p style="background-color:#dfdfdf; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">&lt;/fieldset&gt;</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">运行效果：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.007.png" width="452" height="265" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-indent:19.5pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">4</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font-family:宋体; font-size:12pt">上传的附件保存在“</span><span style="font-family:'Times New Roman'; font-size:12pt">sys_BillAttach</span><span style="font-family:宋体; font-size:12pt">”表内，相关的实现代码通过</span><span style="font-family:宋体; font-size:12pt"> </span><span style="font-family:宋体; font-size:12pt">“</span><span style="color:#2b91af; font-family:NSimSun; font-size:12pt">sys_BillAttach</span><span style="font-family:宋体; font-size:12pt">”控制器实现的。</span></p><h2 style="font-size:16pt; line-height:125%; margin:0pt 0pt 0pt 28.35pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-28.35pt; widows:0"><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">11.3.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:黑体; font-size:16pt; font-weight:bold">富文本编辑器</span></h2><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在开发项目过程中，遇到公告内容，新闻内容之类的字段时，数据库字段类型应该选择</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">“</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">nvarchar(max)</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">或者</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">ntext</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">”</span><span style="font-family:宋体; font-size:12pt">类型，这种类型的</span><span style="font-family:宋体; font-size:12pt">字段</span><span style="font-family:宋体; font-size:12pt">允许录入的内容特别多（例如图书表的图书介绍，作者介绍，图书目录等字段），为了方便对录入的内容进行排版，需要提供类似于</span><span style="font-family:'Times New Roman'; font-size:12pt">Word</span><span style="font-family:宋体; font-size:12pt">的网页插件，这类插件称为</span><span style="font-family:宋体; font-size:12pt">“</span><span style="font-family:宋体; font-size:12pt">富文本编辑器</span><span style="font-family:宋体; font-size:12pt">”</span><span style="font-family:宋体; font-size:12pt">，这类插件类似于网页编辑器，能够编辑要展示的网页内容，在项目中，我们选择百度的</span><span style="font-family:'Times New Roman'; font-size:12pt">u</span><span style="font-family:'Times New Roman'; font-size:12pt">Editor</span><span style="font-family:宋体; font-size:12pt">插件，具体使用方法见下边的步骤。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">以</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">图书介绍</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">和作者介绍</span><span style="font-family:宋体; font-size:12pt">为例</span><span style="font-family:宋体; font-size:12pt">介绍如何完成</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.3.1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">视图中</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">引入</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">JS</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">库</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:宋体; font-size:12pt">图书</span><span style="font-family:宋体; font-size:12pt">维护</span><span style="font-family:宋体; font-size:12pt">新增，修改，详情</span><span style="font-family:宋体; font-size:12pt">视图</span><span style="font-family:宋体; font-size:12pt">页面顶部引入</span><span style="font-family:'Times New Roman'; font-size:12pt">u</span><span style="font-family:'Times New Roman'; font-size:12pt">Editor</span><span style="font-family:宋体; font-size:12pt">插件的相关</span><span style="font-family:'Times New Roman'; font-size:12pt">JS</span><span style="font-family:宋体; font-size:12pt">资源</span></p><p style="background-color:#dfdfdf; font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">&lt;script type="text/javascript" charset="utf-8" src="/uEditor/ueditor.config.js"&gt;&lt;/script&gt;</span></p><p style="background-color:#dfdfdf; font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">&lt;script type="text/javascript" charset="utf-8" src="/uEditor/ueditor.all.min.js"&gt;&lt;/script&gt;</span></p><p style="background-color:#dfdfdf; font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">&lt;script type="text/javascript" charset="utf-8" src="/uEditor/lang/zh-cn/zh-cn.js"&gt;&lt;/script&gt;</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.3.2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">调整视图所用</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">控件表单</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在新增和修改视图上</span><span style="font-family:宋体; font-size:12pt">更换需要富文本框的字段控件</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">当一个界面需要多个</span><span style="font-family:'Times New Roman'; font-size:12pt">u</span><span style="font-family:'Times New Roman'; font-size:12pt">Editor</span><span style="font-family:宋体; font-size:12pt">插件的时候，名称上需要加上字段后缀</span><span style="font-family:宋体; font-size:12pt">方便区分，如果只有一个，则可以不用加上字段名后缀了</span><span style="font-family:宋体; font-size:12pt">。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">这里的“</span><span style="font-family:'Times New Roman'; font-size:12pt">uEditorProxy</span><span style="font-family:宋体; font-size:12pt">”是一个代理表单，</span><span style="font-family:'Times New Roman'; font-size:12pt">u</span><span style="font-family:'Times New Roman'; font-size:12pt">Editor</span><span style="font-family:宋体; font-size:12pt">控件</span><span style="font-family:宋体; font-size:12pt">录入</span><span style="font-family:宋体; font-size:12pt">的值无法与模型进行绑定，需要提供一个代理表单</span><span style="font-family:宋体; font-size:12pt">控件</span><span style="font-family:宋体; font-size:12pt">。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码文件：</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">Code01.txt</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.008.png" width="576" height="222" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.3.3.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">编写</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">JS</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码完成代理控制</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在新增和修改视图的顶部</span><span style="font-family:宋体; font-size:12pt">编写</span><span style="font-family:'Times New Roman'; font-size:12pt">JS</span><span style="font-family:宋体; font-size:12pt">代码完成代理表单和</span><span style="font-family:'Times New Roman'; font-size:12pt">u</span><span style="font-family:'Times New Roman'; font-size:12pt">Editor</span><span style="font-family:宋体; font-size:12pt">值</span><span style="font-family:宋体; font-size:12pt">之间的互动</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码放在</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">uEditor</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">资源引入的下方</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码文件：</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">Code02.txt</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.009.png" width="555" height="383" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">代码解读：</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">1</span><span style="font-family:宋体; font-size:10.5pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:10.5pt">当</span><span style="font-family:'Times New Roman'; font-size:10.5pt">uEditor</span><span style="font-family:宋体; font-size:10.5pt">控件</span><span style="font-family:宋体; font-size:10.5pt">初始化后，获取代理表单上的值，并复制给</span><span style="font-family:'Times New Roman'; font-size:10.5pt">uEditor</span><span style="font-family:宋体; font-size:10.5pt">控件。</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">2</span><span style="font-family:宋体; font-size:10.5pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:10.5pt">提供</span><span style="font-family:'Times New Roman'; font-size:10.5pt">saveBefore</span><span style="font-family:宋体; font-size:10.5pt">方法，该方法会在保存按钮请求后台</span><span style="font-family:'Times New Roman'; font-size:10.5pt">Action</span><span style="font-family:宋体; font-size:10.5pt">之前执行，该方法负责把</span><span style="font-family:'Times New Roman'; font-size:10.5pt">uEditor</span><span style="font-family:宋体; font-size:10.5pt">控件上的值获取过来并赋值给代理表单，通过代理表单将值传递给后端。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.3.4.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">在控制器上加上特性</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:宋体; font-size:12pt">新增和修改</span><span style="font-family:宋体; font-size:12pt">的</span><span style="font-family:'Times New Roman'; font-size:12pt">Post</span><span style="font-family:宋体; font-size:12pt">请求的</span><span style="font-family:'Times New Roman'; font-size:12pt">Action</span><span style="font-family:宋体; font-size:12pt">上方</span><span style="font-family:宋体; font-size:12pt">增加如下过滤器。</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">[ValidateInput(false)]</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">该特性用来设置是否对提交的内容进行合法性检测</span><span style="font-family:宋体; font-size:12pt">，富文本内容提交必须加上这个。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.3.5.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">详情视图展示内容</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">在详情视图哪里</span><span style="font-family:宋体; font-size:12pt">修改</span><span style="font-family:宋体; font-size:12pt">代码来展示富文本内容。</span><span style="font-family:宋体; font-size:12pt"> </span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码文件：</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">C</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">ode03.txt</span></p><p style="font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.010.png" width="503" height="252" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.3.6.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">运行代码查看效果</span></h3><p style="font-size:16pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:15.85pt; widows:0"><img src="index.011.png" width="498" height="281" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:16pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:15.85pt; widows:0"><span style="color:#eeece1; font-family:宋体; font-size:16pt; font-weight:bold">辅助</span><span style="color:#eeece1; font-family:宋体; font-size:16pt; font-weight:bold">练习</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">1</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font-family:宋体; font-size:12pt">将“</span><span style="font-family:'Times New Roman'; font-size:12pt">bookDirectory</span><span style="font-family:宋体; font-size:12pt">”字段也变更为富文本方式。</span></p><h2 style="font-size:16pt; line-height:125%; margin:0pt 0pt 0pt 28.35pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-28.35pt; widows:0"><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">11.4.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">Excel</span><span style="font-family:黑体; font-size:16pt; font-weight:bold">导入</span></h2><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:宋体; font-size:12pt">项目开发过程中，</span><span style="font-family:宋体; font-size:12pt">客户的基础数据以前都保存在</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">中，当使用系统后，他们不想</span><span style="font-family:宋体; font-size:12pt">通过新增方式</span><span style="font-family:宋体; font-size:12pt">一条条的</span><span style="font-family:宋体; font-size:12pt">录入系统中，因此需要为客户提供数据的批量导入功能，具体的开发步骤如下：</span><span style="font-family:宋体; font-size:12pt">以</span><span style="font-family:宋体; font-size:12pt">批量导入出版社为例。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.4.1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">准备</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">Excel</span><span style="font-family:宋体; font-size:12pt; font-weight:bold">模板文件和数据文件</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">把空的</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">模板文件保存在</span><span style="font-family:'Times New Roman'; font-size:12pt">/upload/</span><span style="font-family:'Times New Roman'; font-size:12pt">excelTemplate</span><span style="font-family:宋体; font-size:12pt">目录内，文件名用表名命名。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.012.png" width="292" height="77" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.4.2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">为表增加批量保存方法</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:宋体; font-size:12pt">出版社的</span><span style="font-family:宋体; font-size:12pt">业务类</span><span style="font-family:宋体; font-size:12pt">中</span><span style="font-family:宋体; font-size:12pt">增加批量保存的业务方法</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码文件：</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">code04.txt</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.013.png" width="576" height="524" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-17.7pt; widows:0"><span style="font-family:Wingdings; font-size:12pt"></span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码解读：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">1</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">为了防止主键重复，首先查询处数据库中已经存在的数据</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">2</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">从内置对象中获取上传的数据（上传的数据默认保存在这个对象中，上传代码框架已统一写好。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">3</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">通过事务保证导入数据的一致性。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">4</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">对导入的数据进行合法性检查</span><span style="font-family:宋体; font-size:12pt">，需要那些检查根据表的业务需求。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.4.3.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">调用用户的批量导入方法</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在“</span><span style="font-family:'Times New Roman'; font-size:12pt">sys_ExlImport</span><span style="font-family:宋体; font-size:12pt">”类的“</span><span style="font-family:'Times New Roman'; font-size:12pt">importData</span><span style="font-family:宋体; font-size:12pt">”方法内增加代码来调用对应的保存方法</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">该代码位于</span><span style="font-family:'Times New Roman'; font-size:12pt">dbLibrary/prj</span><span style="font-family:'Times New Roman'; font-size:12pt">/</span><span style="font-family:'Times New Roman'; font-size:12pt">sys_ExlImport</span><span style="font-family:宋体; font-size:12pt">文件中</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">public class sys_ExlImport</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">{</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    public static void importData(string tableName)</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    {</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="width:18pt; text-indent:0pt; display:inline-block"></span><span style="width:21pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Times New Roman'; font-size:10.5pt">//</span><span style="font-family:宋体; font-size:10.5pt">根据表名调用对应业务类内的业务方法</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:'Times New Roman'; font-size:10.5pt">if (tableName == "bks_Press")</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">            db.bll.bks_Press.SaveData(</span><span style="font-family:'Times New Roman'; font-size:10.5pt">null</span><span style="font-family:'Times New Roman'; font-size:10.5pt">);</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">    }</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">}</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.4.4.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">增加导入按钮</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">1</span><span style="font-family:宋体; font-size:12pt">、</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">在出版社的主界面工具栏</span><span style="font-family:宋体; font-size:12pt">内</span><span style="font-family:宋体; font-size:12pt">增加</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">导入按钮</span><span style="font-family:宋体; font-size:12pt">。</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">@Html.ActionLink("Excel</span><span style="font-family:宋体; font-size:10.5pt">导入</span><span style="font-family:'Times New Roman'; font-size:10.5pt">", "Import", "sys_ExlImport", new { </span><span style="color:#ff0000; font-family:'Times New Roman'; font-size:10.5pt; font-weight:bold">tableName = "bks_Press"</span><span style="font-family:'Times New Roman'; font-size:10.5pt"> }, new { data_sh</span><span style="font-family:'Times New Roman'; font-size:10.5pt">ow = </span><span style="font-family:'Times New Roman'; font-size:10.5pt">rui</span><span style="font-family:'Times New Roman'; font-size:10.5pt">.privCtl.isPriv(ctrl, </span><span style="font-family:'Times New Roman'; font-size:10.5pt">rui</span><span style="font-family:'Times New Roman'; font-size:10.5pt">.privCtl.eOp.Import), @class = "showDialogR opImport" })</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">tableName</span><span style="font-family:宋体; font-size:12pt">属性一定要等于要导入的表名称。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.4.5.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">框架代码完成的工作</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21.25pt; widows:0"><span style="font-family:宋体; font-size:12pt">点击导入按钮后，显示</span><span style="font-family:宋体; font-size:12pt">导入窗口</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21.25pt; widows:0"><span style="font-family:宋体; font-size:12pt">选择文件后，</span><span style="font-family:宋体; font-size:12pt">点击“上传并展示”</span><span style="font-family:宋体; font-size:12pt">将要导入的文件上传到服务器上</span><span style="font-family:宋体; font-size:12pt">读取上传文件中的数据保存到内置对象中，并展示所读取的数据</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:21.25pt; widows:0"><span style="font-family:宋体; font-size:12pt">点击“保存到数据库”后</span><span style="font-family:宋体; font-size:12pt">，</span><span style="font-family:宋体; font-size:12pt">调用</span><span style="font-family:'Times New Roman'; font-size:10.5pt">sys_ExlImport</span><span style="font-family:'Times New Roman'; font-size:10.5pt">.</span><span style="font-family:'Times New Roman'; font-size:10.5pt">importData</span><span style="font-family:宋体; font-size:12pt">方法内的代码，根据传入的表名调用用户所写的批量导入业务方法。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">框架实现的代码都位于</span><span style="font-family:'Times New Roman'; font-size:12pt">“sys_ExlImportController”</span><span style="font-family:宋体; font-size:12pt">控制器内。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.4.6.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">运行程序查看效果</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.014.png" width="576" height="138" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><img src="index.015.png" width="576" height="325" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><h2 style="font-size:16pt; line-height:125%; margin:0pt 0pt 0pt 28.35pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-28.35pt; widows:0"><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">11.5.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:'Times New Roman'; font-size:16pt; font-weight:bold">Excel</span><span style="font-family:黑体; font-size:16pt; font-weight:bold">导出</span></h2><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在项目开发过程中</span><span style="font-family:宋体; font-size:12pt">，客户需要把相关的数据导出用于其它用途</span><span style="font-family:宋体; font-size:12pt">，因此主界面中还需要提供数据导出的功能，能够把需要导出的数据导出为</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">文件，具体的开发步骤如下：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">导出用</span><span style="font-family:宋体; font-size:12pt">到</span><span style="font-family:宋体; font-size:12pt">了</span><span style="font-family:'Times New Roman'; font-size:12pt">Aspose.Cell</span><span style="font-family:宋体; font-size:12pt">组件，组件的使用</span><span style="font-family:宋体; font-size:12pt">细节</span><span style="font-family:宋体; font-size:12pt">可以参考网络文档。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">以图书导出为例</span><span style="font-family:宋体; font-size:12pt">介绍如何实现。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.5.1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">添加导出的</span><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">Action</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:'Times New Roman'; font-size:12pt">book</span><span style="font-family:宋体; font-size:12pt">的</span><span style="font-family:'Times New Roman'; font-size:12pt">Controller</span><span style="font-family:宋体; font-size:12pt">内提供导出的</span><span style="font-family:'Times New Roman'; font-size:12pt">Action</span><span style="font-family:宋体; font-size:12pt">“</span><span style="font-family:'Times New Roman'; font-size:12pt">SelectExport</span><span style="font-family:宋体; font-size:12pt">”</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">public ActionResult SelectExport(db.view.bks_Book model)</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">{</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      try</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      {</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">           //all</span><span style="font-family:宋体; font-size:10.5pt">代表要导出查询的所有数据</span><span style="font-family:'Times New Roman'; font-size:10.5pt">,page</span><span style="font-family:宋体; font-size:10.5pt">代表导出本页的数据</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:10.5pt">           </span><span style="font-family:'Times New Roman'; font-size:10.5pt">model.ExportRange = rui.dataRange.all.ToString();</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">           model.SheetName = "</span><span style="font-family:宋体; font-size:10.5pt">图书信息</span><span style="font-family:'Times New Roman'; font-size:10.5pt">";</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">           model.Search();</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">           return File(model.ExportToXls(), rui.innerCode.mime(".xlsx"), "</span><span style="font-family:宋体; font-size:10.5pt">图书信息</span><span style="font-family:'Times New Roman'; font-size:10.5pt">.xlsx");</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      }</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      catch (Exception ex)</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      {</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">           rui.logHelper.log(ex);</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">           Response.Write(string.Format("&lt;script&gt;alert('{0}');history.go(-1);&lt;/script&gt;", ex.Message));</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      }</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">      return null;</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">}</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 24pt; orphans:0; text-align:justify; widows:0"><img src="index.016.png" width="576" height="219" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 39pt; orphans:0; text-align:justify; text-indent:-17.7pt; widows:0"><span style="font-family:Wingdings; font-size:12pt"></span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">代码解读：</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">1</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">导出的代码和主界面的代码有点相似，</span><span style="font-family:宋体; font-size:12pt">传入相同的视图模型。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">2</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">在代码职工需要设定要导出数据的范围（本页数据还是搜索的所有数据），导出的</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">单元格名称。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">3</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">调用</span><span style="font-family:'Times New Roman'; font-size:12pt">Search</span><span style="font-family:宋体; font-size:12pt">方法</span><span style="font-family:宋体; font-size:12pt">时</span><span style="font-family:宋体; font-size:12pt">，该方法会根据</span><span style="font-family:宋体; font-size:12pt">前两个变量的配置，获取合适的数据，并将其生成到</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">文件流中</span><span style="font-family:宋体; font-size:12pt">（这部分代码框架中统一写好了）</span><span style="font-family:宋体; font-size:12pt">。</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt">4</span><span style="font-family:宋体; font-size:12pt">）</span><span style="font:7.0pt 'Times New Roman'">&#xa0; </span><span style="font-family:宋体; font-size:12pt">通过</span><span style="font-family:'Times New Roman'; font-size:12pt">model.ExportToXls()</span><span style="font-family:宋体; font-size:12pt">方法获取</span><span style="font-family:'Times New Roman'; font-size:12pt">Excel</span><span style="font-family:宋体; font-size:12pt">的文件名，设定导出的文件</span><span style="font-family:'Times New Roman'; font-size:12pt">MIME</span><span style="font-family:宋体; font-size:12pt">类型，设定导出文件名，即可实现文件的导出。</span></p><h3 style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 42.8pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; text-indent:-42.8pt; widows:0"><span style="font-family:'Times New Roman'; font-size:12pt; font-weight:bold">11.5.2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt; font-weight:bold">添加导出按钮</span></h3><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">在图书的主界面中提供导出按钮</span><span style="font-family:宋体; font-size:12pt">，运行程序查看运行效果，导出的列和展示的列保持一致。</span></p><p style="background-color:#dfdfdf; font-size:10.5pt; line-height:125%; margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:'Times New Roman'; font-size:10.5pt">@Html.ActionLink("Excel</span><span style="font-family:宋体; font-size:10.5pt">导出</span><span style="font-family:'Times New Roman'; font-size:10.5pt">", "SelectExport", null, new { @class = "opExlExport" })</span></p><p style="font-size:12pt; line-height:125%; margin:0pt 0pt 0pt 24pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">运行代码查看效果。</span></p><div style="-aw-headerfooter-type:footer-primary"><p style="margin:0pt; orphans:0; text-align:center; widows:0"><span style="font-family:宋体; font-size:9pt">第</span><span style="font-family:宋体; font-size:9pt"> </span><span style="-aw-field-code:' PAGE '"><span style="font-family:'Times New Roman'; font-size:9pt">1</span></span><span style="font-family:'Times New Roman'; font-size:9pt"> </span><span style="font-family:宋体; font-size:9pt">页</span><span style="font-family:宋体; font-size:9pt"> </span><span style="font-family:宋体; font-size:9pt">共</span><span style="font-family:宋体; font-size:9pt"> </span><span style="font-family:'Times New Roman'; font-size:9pt">10</span><span style="font-family:'Times New Roman'; font-size:9pt"> </span><span style="font-family:宋体; font-size:9pt">页</span></p></div></div></body></html>